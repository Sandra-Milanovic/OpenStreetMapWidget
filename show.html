<html>
<head>
<link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.css" />
<!--[if lte IE 8]>
<link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.ie.css" />
<![endif]-->

<style type="text/css">
	body {
		padding:0;
		margin:0;
	}
</style>
</head>
<body>
<div id="map" style="height: 400px"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://code.leafletjs.com/leaflet-0.3.1/leaflet.js"></script>
<script type="text/javascript">
//show.html?lat=lat&lngr=lng&zoom=zoom&marker=lat,lng
var getParams = function() {
	var params = {}; 
	var paramArray = window.location.search.substr(1).split("&");
	for (var k = 0; k < paramArray.length; ++k) {
		var single = paramArray[k].split("=");
		params[single[0]] = single[1] 
	}
	return params; 
};

$(window).resize(function (){
	$("#map").width($(window).width());
	$("#map").height($(window).height());
})

$(document).ready(function() {
	var params = getParams();
	if ("marker" in params) {
		var markerArray = params.marker.split(","),
		markerLat = markerArray[0],
		markerLng = markerArray[1];
	}
	
	$("#map").width($(window).width());
	$("#map").height($(window).height()); 
	var map = new L.Map('map');
	var layer = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
		attribution:'Copyright (C) OpenStreetMap.org',
		maxZoom:18
	});
	$("#map").width($(window).width());
	$("#map").height($(window).height()); 
	map.addLayer(layer);
	map.setView(new L.LatLng(params.lat,params.lng), params.zoom);

	if ("marker" in params) {
		var markerLocation = new L.LatLng(markerLat, markerLng);
		var marker = new L.Marker(markerLocation);
		map.addLayer(marker);
	}
});

</script>
</body>
</html>
